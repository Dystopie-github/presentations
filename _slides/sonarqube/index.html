---
title: sonarqube
description: using sonarqube with jenkins pipeline for code analysis and for basic security analysis
theme: black
date: 2017-09-02
reveal_config:
  controls: true
  progress: true
  transition: slide
  slideNumber: true
---
<section data-markdown>
    # sonarqube
    #### Jenkins pipeline
    #### security code analysis
</section>
<section>
  <section>
    <h1> À propos de moi</h1>
  </section>
  <section data-markdown>
    ## Marc-André Lagacé

    7 ans d'expérience en TI

    - Spécialiste en déploiment et intégration continue
    - Étudiant au bacc en cybersécurité à PolyMTL
  </section>
</section>
<section>
    <section data-markdown>
        # sonarqube
        #### What is it?
    </section>
    <section>
        <section data-markdown>
           #### Features
           - Can work with git
           - Authentification with LDAP, Google, gitlab, github, bitbucket and AD
           - Can analyze code directly in git or Jenkins slave
           - Need a database: MSSQL, MySQL, Oracle and PostgreSQL
           - Come with builtin web server, Elasticsearch and Compute Engine
        </section>
        <section data-markdown>
           #### sonarqube is a multi-language code scanner
           - Support over 20 different language
           - Support multi language project
           - PHP + js + css
        </section>
        <section data-markdown>
           #### Scan code for Bugs and Vulnerabilities
           - Continious inspection
           - Keep track of history
           - Bugs, Code smell and vulnerabilities
           - Expect false positif
           - Specify custom module path
           - Specific scaner by language 
        </section>
        <section data-markdown>
           #### static code analyzer for PHP
           - Can be integrated to IDE (Eclipse + other)
           - More then 128 rules
           - Check for over 10 specific php vulnerabilities
           - Will check for Drupal Best practice (Drupal profile)
        </section>
        <section data-markdown>
           #### Security
           - sonarqube is a static code analyzer, not a pentest tools
           - Can scan for CWE, SANS top 25, OWASP, MISRA and CERT
           [Reference for php scaner](https://www.sonarsource.com/products/codeanalyzers/sonarphp.html)
        </section>
        <section data-markdown>
           #### OnPremise and cloud version
           - OnPremise version require:  Open Source project
        </section>
    </section>
</section>
<section>
  <section data-markdown>
    # Can be automated with Jenkins!
    ##### Code example in the next page
  </section>
<section data-markdown>
### Jenkins pipeline code
```groovy
node {
   stage('SCM') { git 'https://github.com/foo/bar.git' }
   stage('SonarQube analysis') {
      withSonarQubeEnv('My SonarQube Server') {
         sh 'mvn clean package sonar:sonar'
       } // SonarQube taskId is automatically attached to the pipeline context
   }
}
// No need to occupy a node
stage("Quality Gate"){
   timeout(time: 1, unit: 'HOURS') { // Just in case something goes wrong, pipeline will be killed after a timeout
      def qg = waitForQualityGate() // Reuse taskId previously collected by withSonarQubeEnv
      if (qg.status != 'OK') {
      error "Pipeline aborted due to quality gate failure: ${qg.status}"
    }
  }
}
```
 </section>
</section>